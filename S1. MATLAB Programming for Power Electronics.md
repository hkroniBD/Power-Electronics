# 🔌 MATLAB Programming for Power Electronics
## A Comprehensive Guide for Electrical Engineering Students
---

## 📚 **Lecture Outline**

| Section | Topic | Duration | 🎯 Key Learning Outcome |
|---------|-------|----------|------------------------|
| 1 | Introduction & Setup | 15 min | MATLAB environment for power electronics |
| 2 | Basic Circuit Analysis | 25 min | Implement circuit equations |
| 3 | Power Converter Modeling | 30 min | Model DC-DC converters |
| 4 | Switching Circuits | 25 min | Simulate switching behavior |
| 5 | Control Systems | 20 min | Design feedback controllers |
| 6 | Advanced Applications | 15 min | Real-world examples |

---

## 🚀 **Section 1: Introduction & MATLAB Setup for Power Electronics**

### Why MATLAB for Power Electronics? 🤔

| Advantage | Description | 🔧 Tool |
|-----------|-------------|--------|
| **Simulation Speed** | Fast numerical computation | Simulink |
| **Visualization** | Excellent plotting capabilities | plot(), scope |
| **Toolboxes** | Specialized power system tools | SimPowerSystems |
| **Control Design** | Built-in control system tools | Control Toolbox |

### Essential MATLAB Toolboxes 📦

```matlab
% Check installed toolboxes
ver
% Key toolboxes for power electronics:
% - Simulink
% - SimPowerSystems (Simscape Electrical)
% - Control System Toolbox
% - Signal Processing Toolbox
```

---

## ⚡ **Section 2: Basic Circuit Analysis**

### 🔍 **Example 1: RC Circuit Analysis**

**Problem:** Analyze the transient response of an RC circuit with R=1kΩ, C=1μF, and input voltage step from 0V to 12V.

```matlab
% RC Circuit Transient Analysis
clear; clc; close all;

% Circuit parameters
R = 1000;           % Resistance in Ohms
C = 1e-6;           % Capacitance in Farads
V_in = 12;          % Input voltage in Volts
tau = R * C;        % Time constant

% Time vector
t = 0:tau/100:5*tau;

% Analytical solution for step response
V_c = V_in * (1 - exp(-t/tau));  % Capacitor voltage
I_c = (V_in/R) * exp(-t/tau);    % Capacitor current

% Plotting
figure('Name', 'RC Circuit Response');
subplot(2,1,1);
plot(t*1000, V_c, 'b-', 'LineWidth', 2);
grid on;
xlabel('Time (ms)');
ylabel('Voltage (V)');
title('📈 Capacitor Voltage vs Time');
legend('V_C(t)');

subplot(2,1,2);
plot(t*1000, I_c*1000, 'r-', 'LineWidth', 2);
grid on;
xlabel('Time (ms)');
ylabel('Current (mA)');
title('📈 Capacitor Current vs Time');
legend('I_C(t)');
```

### 🎯 **Key Learning Points:**
- Time constant τ = RC determines response speed
- 63.2% of final value reached at t = τ
- Current peaks at t = 0 and decays exponentially

---

## 🔄 **Section 3: Power Converter Modeling**

### **Example 2: Buck Converter Analysis** 📉

**Problem:** Model a buck converter with Vin=24V, Vout=12V, L=100μH, C=470μF, fs=50kHz.

```matlab
% Buck Converter Analysis
clear; clc; close all;

% Converter parameters
V_in = 24;          % Input voltage (V)
V_out = 12;         % Desired output voltage (V)
L = 100e-6;         % Inductance (H)
C = 470e-6;         % Capacitance (F)
R_load = 5;         % Load resistance (Ohms)
f_s = 50000;        % Switching frequency (Hz)
T_s = 1/f_s;        % Switching period (s)

% Duty cycle calculation
D = V_out / V_in;   % Duty cycle for buck converter
fprintf('🎯 Required Duty Cycle: %.2f%%\n', D*100);

% Critical inductance calculation
L_crit = R_load * (1-D) * T_s / 2;
fprintf('⚠️  Critical Inductance: %.2f μH\n', L_crit*1e6);
if L > L_crit
    fprintf('✅ Operating in CCM (Continuous Conduction Mode)\n');
else
    fprintf('⚠️  Operating in DCM (Discontinuous Conduction Mode)\n');
end

% Ripple calculations
delta_I_L = V_out * (1-D) * T_s / L;  % Inductor current ripple
delta_V_C = delta_I_L / (8 * f_s * C); % Capacitor voltage ripple

fprintf('📊 Inductor Current Ripple: %.3f A\n', delta_I_L);
fprintf('📊 Output Voltage Ripple: %.1f mV\n', delta_V_C*1000);

% Time simulation
t = 0:T_s/1000:10*T_s;  % Simulate for 10 switching periods

% Switch control signal (PWM)
PWM = (mod(t, T_s) < D*T_s);

% Simplified inductor current (assuming CCM)
I_L_avg = V_out / R_load;
I_L = I_L_avg + (delta_I_L/2) * sawtooth(2*pi*f_s*t, 0.5);

% Output voltage with ripple
V_out_actual = V_out + (delta_V_C/2) * sawtooth(2*pi*f_s*t, 0.5);

% Plotting
figure('Name', 'Buck Converter Waveforms');

subplot(3,1,1);
plot(t*1e6, PWM*V_in, 'k-', 'LineWidth', 1.5);
grid on;
xlabel('Time (μs)');
ylabel('Switch Voltage (V)');
title('🔲 PWM Control Signal');
ylim([-2 26]);

subplot(3,1,2);
plot(t*1e6, I_L, 'b-', 'LineWidth', 2);
grid on;
xlabel('Time (μs)');
ylabel('Current (A)');
title('🌊 Inductor Current');

subplot(3,1,3);
plot(t*1e6, V_out_actual, 'r-', 'LineWidth', 2);
grid on;
xlabel('Time (μs)');
ylabel('Voltage (V)');
title('📈 Output Voltage with Ripple');
```

### 📊 **Converter Comparison Table**

| Converter Type | Voltage Gain | Key Equation | 🎯 Application |
|----------------|--------------|--------------|----------------|
| **Buck** | D | V_out = D × V_in | Step-down |
| **Boost** | 1/(1-D) | V_out = V_in/(1-D) | Step-up |
| **Buck-Boost** | -D/(1-D) | V_out = -D×V_in/(1-D) | Step-up/down, inverted |
| **Cuk** | -D/(1-D) | Continuous input current | Low noise |

---

## 🔀 **Section 4: Switching Circuits & PWM**

### **Example 3: PWM Generation & Analysis** 🎛️

```matlab
% PWM Generation and Harmonic Analysis
clear; clc; close all;

% PWM parameters
f_carrier = 10000;      % Carrier frequency (Hz)
f_modulating = 60;      % Modulating frequency (Hz)
m_a = 0.8;              % Modulation index
T_sim = 3/f_modulating; % Simulation time

% Time vector
dt = 1/(100*f_carrier);  % Small time step
t = 0:dt:T_sim;

% Generate signals
carrier = sawtooth(2*pi*f_carrier*t, 0.5);          % Triangular carrier
modulating = m_a * sin(2*pi*f_modulating*t);        % Sinusoidal reference
PWM_signal = (modulating > carrier);                 % PWM output

% Convert to voltage levels
V_dc = 100;  % DC bus voltage
V_pwm = (2*PWM_signal - 1) * V_dc/2;  % Bipolar PWM (-50V to +50V)

% Low-pass filter for fundamental extraction
fc = 500;   % Cutoff frequency
[b, a] = butter(4, fc/(0.5/dt));  % 4th order Butterworth filter
V_filtered = filtfilt(b, a, V_pwm);

% Plotting
figure('Name', 'PWM Generation and Analysis');

subplot(4,1,1);
plot(t*1000, carrier, 'k--', t*1000, modulating, 'r-', 'LineWidth', 2);
grid on;
xlabel('Time (ms)');
ylabel('Amplitude');
title('🔺 Carrier and Modulating Signals');
legend('Carrier', 'Modulating');

subplot(4,1,2);
plot(t*1000, PWM_signal, 'b-', 'LineWidth', 1.5);
grid on;
xlabel('Time (ms)');
ylabel('Logic Level');
title('🔲 PWM Logic Signal');
ylim([-0.2 1.2]);

subplot(4,1,3);
plot(t*1000, V_pwm, 'g-', 'LineWidth', 1);
grid on;
xlabel('Time (ms)');
ylabel('Voltage (V)');
title('⚡ Bipolar PWM Output');

subplot(4,1,4);
plot(t*1000, V_filtered, 'r-', t*1000, m_a*V_dc/2*sin(2*pi*f_modulating*t), 'k--', 'LineWidth', 2);
grid on;
xlabel('Time (ms)');
ylabel('Voltage (V)');
title('🌊 Filtered Output vs Ideal Sine Wave');
legend('Filtered PWM', 'Ideal Sine');

% FFT Analysis
N = length(V_pwm);
f = (0:N-1)*(1/dt)/N;
Y = fft(V_pwm)/N;

figure('Name', 'PWM Frequency Spectrum');
semilogx(f(1:N/2), 20*log10(abs(Y(1:N/2))), 'b-', 'LineWidth', 1.5);
grid on;
xlabel('Frequency (Hz)');
ylabel('Magnitude (dB)');
title('📊 PWM Frequency Spectrum');
xlim([1 100000]);
```

---

## 🎛️ **Section 5: Control Systems for Power Electronics**

### **Example 4: PI Controller Design for Buck Converter** ⚙️

```matlab
% PI Controller Design for Buck Converter
clear; clc; close all;

% System parameters
V_in = 24;      % Input voltage
L = 100e-6;     % Inductance
C = 470e-6;     % Capacitance  
R = 5;          % Load resistance
V_ref = 12;     % Reference voltage

% Small-signal model (continuous time)
s = tf('s');
G_plant = (V_in/L) / (s^2 + s/(R*C) + 1/(L*C));  % Plant transfer function

% PI Controller design
% Desired crossover frequency and phase margin
f_c = 1000;     % Crossover frequency (Hz)
omega_c = 2*pi*f_c;
PM_desired = 60;  % Phase margin (degrees)

% Calculate PI parameters
[mag, phase] = bode(G_plant, omega_c);
K_p = 1 / mag;  % Proportional gain
T_i = 1 / (omega_c * tan(deg2rad(PM_desired/2)));  % Integral time constant
K_i = K_p / T_i;  % Integral gain

fprintf('🎯 PI Controller Parameters:\n');
fprintf('   K_p = %.3f\n', K_p);
fprintf('   K_i = %.1f\n', K_i);

% PI Controller transfer function
G_controller = K_p + K_i/s;

% Open-loop and closed-loop transfer functions
G_open = G_controller * G_plant;
G_closed = feedback(G_open, 1);

% Analysis plots
figure('Name', 'Control System Analysis');

% Bode plot
subplot(2,2,1);
bode(G_open);
grid on;
title('📊 Open-Loop Bode Plot');

% Root locus
subplot(2,2,2);
rlocus(G_open);
grid on;
title('🎯 Root Locus');

% Step response
subplot(2,2,3);
step(G_closed);
grid on;
title('📈 Closed-Loop Step Response');

% Load disturbance response
G_disturbance = feedback(G_plant, G_controller);
subplot(2,2,4);
step(G_disturbance);
grid on;
title('⚡ Load Disturbance Response');

% Performance metrics
info = stepinfo(G_closed);
fprintf('📊 Performance Metrics:\n');
fprintf('   Rise Time: %.3f ms\n', info.RiseTime*1000);
fprintf('   Settling Time: %.3f ms\n', info.SettlingTime*1000);
fprintf('   Overshoot: %.1f%%\n', info.Overshoot);
```

### 🎯 **Control Design Guidelines**

| Parameter | Typical Range | Effect | 💡 Design Tip |
|-----------|---------------|--------|----------------|
| **Crossover Frequency** | fs/10 to fs/5 | Bandwidth vs stability | Lower for noisy systems |
| **Phase Margin** | 45° - 60° | Stability margin | Higher for robustness |
| **Gain Margin** | > 6 dB | Stability margin | Check with variations |

---

## 🌟 **Section 6: Advanced Applications**

### **Example 5: Three-Phase Inverter Simulation** 🔄

```matlab
% Three-Phase Inverter with Space Vector Modulation
clear; clc; close all;

% Parameters
V_dc = 400;         % DC bus voltage
f_out = 50;         % Output frequency
f_s = 10000;        % Switching frequency
m = 0.9;            % Modulation index
T_sim = 3/f_out;    % Simulation time

% Time vector
dt = 1/(100*f_s);
t = 0:dt:T_sim;

% Three-phase reference voltages
V_a_ref = m * cos(2*pi*f_out*t);
V_b_ref = m * cos(2*pi*f_out*t - 2*pi/3);
V_c_ref = m * cos(2*pi*f_out*t - 4*pi/3);

% Space vector modulation (simplified)
% Convert to alpha-beta coordinates
V_alpha = V_a_ref;
V_beta = (V_a_ref + 2*V_b_ref) / sqrt(3);

% Calculate sector and switching times
theta = atan2(V_beta, V_alpha);
theta(theta < 0) = theta(theta < 0) + 2*pi;

% Generate PWM signals (simplified implementation)
carrier = sawtooth(2*pi*f_s*t, 0.5);
PWM_a = (V_a_ref > carrier);
PWM_b = (V_b_ref > carrier);
PWM_c = (V_c_ref > carrier);

% Line voltages
V_ab = (PWM_a - PWM_b) * V_dc;
V_bc = (PWM_b - PWM_c) * V_dc;
V_ca = (PWM_c - PWM_a) * V_dc;

% Plotting
figure('Name', 'Three-Phase Inverter Output');

subplot(3,1,1);
plot(t*1000, [V_a_ref; V_b_ref; V_c_ref], 'LineWidth', 2);
grid on;
xlabel('Time (ms)');
ylabel('Reference');
title('🔄 Three-Phase Reference Voltages');
legend('V_a', 'V_b', 'V_c');

subplot(3,1,2);
plot(t*1000, [PWM_a; PWM_b; PWM_c], 'LineWidth', 1.5);
grid on;
xlabel('Time (ms)');
ylabel('PWM State');
title('🔲 PWM Switching States');
legend('PWM_a', 'PWM_b', 'PWM_c');
ylim([-0.2 1.2]);

subplot(3,1,3);
plot(t*1000, V_ab, 'r-', t*1000, V_bc, 'g-', t*1000, V_ca, 'b-', 'LineWidth', 1.5);
grid on;
xlabel('Time (ms)');
ylabel('Voltage (V)');
title('⚡ Line-to-Line Output Voltages');
legend('V_{ab}', 'V_{bc}', 'V_{ca}');
```

---

## 🎓 **Learning Objectives Summary**

### ✅ **By the end of this lecture, students should be able to:**

1. **🔧 Setup MATLAB Environment**
   - Configure essential toolboxes
   - Understand workspace organization

2. **⚡ Analyze Power Circuits**
   - Model passive components
   - Calculate transient responses
   - Simulate circuit behavior

3. **🔄 Design Power Converters**
   - Calculate converter parameters
   - Analyze ripple and efficiency
   - Compare different topologies

4. **🎛️ Implement Control Systems**
   - Design PI/PID controllers
   - Analyze stability and performance
   - Simulate closed-loop behavior

5. **🌊 Generate and Analyze PWM**
   - Create switching waveforms
   - Perform harmonic analysis
   - Optimize switching strategies

---

## 📚 **Recommended Resources**

### 📖 **Books**
- "Power Electronics: Converters, Applications, and Design" - Mohan, Undeland, Robbins
- "Modern Power Electronics and AC Drives" - Bose

### 🌐 **MATLAB Resources**
- MATLAB Power Electronics Documentation
- Simulink Power Systems Examples
- MathWorks Power Electronics Community

### 🛠️ **Practice Exercises**
1. Design a boost converter for LED driver application
2. Implement SPWM for single-phase inverter
3. Model and control a flyback converter
4. Analyze harmonic distortion in power systems

---

## 🎯 **Assessment Criteria**

| Category | Weight | 📊 Evaluation Method |
|----------|--------|---------------------|
| **Code Quality** | 25% | Clarity, comments, efficiency |
| **Technical Accuracy** | 35% | Correct equations and results |
| **Analysis & Interpretation** | 25% | Understanding of results |
| **Presentation** | 15% | Plots, documentation, organization |

---

### 💡 **Tips for Success**

🔹 **Always validate results** with hand calculations
🔹 **Use meaningful variable names** for clarity
🔹 **Comment your code** thoroughly
🔹 **Plot intermediate results** to debug
🔹 **Compare with theoretical predictions**
🔹 **Consider practical limitations** (component tolerances, parasitics)

---

*"In power electronics, simulation is not just about getting the right answer - it's about understanding the physics behind the waveforms!"* ⚡

---
