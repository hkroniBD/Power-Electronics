# Modulation Techniques in Power Electronics
- 🎓 EEE 513 - Advanced Power Electronics (2.00 Credits) | Lecture 1
- 👨‍🎓 Md. Hassanul Karim Roni, Assistant Professor, EEE, HSTU, Dinajpur
- 📧 hkroni@tch.hstu.ac.bd

---

## Learning Objectives
By the end of this lecture, students will be able to:
- Understand the fundamental principles of modulation in power electronics
- Analyze different PWM techniques and their characteristics
- Design and implement sinusoidal PWM (SPWM) systems
- Understand space vector modulation (SVM) theory and implementation
- Compare various modulation strategies for different applications
- Calculate harmonic content and switching losses for different techniques
- Select appropriate modulation methods for specific converter requirements
- Implement advanced modulation techniques for multilevel converters

---

## 1. Introduction to Modulation in Power Electronics

### 1.1 What is Modulation?

**Modulation** in power electronics is the process of controlling the switching of power semiconductor devices to achieve desired output voltage and current waveforms while minimizing unwanted harmonics.

### 1.2 Why is Modulation Important?

#### **Key Benefits:**
- **Harmonic Control**: Reduces total harmonic distortion (THD)
- **Voltage Control**: Enables variable output voltage from fixed DC input
- **Frequency Control**: Allows variable frequency operation
- **Power Quality**: Improves output waveform quality
- **Efficiency**: Optimizes switching losses vs. harmonic content

#### **Design Objectives:**
1. **Minimize harmonic distortion**
2. **Maximize fundamental component**
3. **Optimize switching frequency**
4. **Reduce switching losses**
5. **Ensure linear control range**

### 1.3 Classification of Modulation Techniques

#### **By Switching Pattern:**
- **Square Wave Modulation**: Fixed switching pattern
- **Pulse Width Modulation (PWM)**: Variable pulse width
- **Pulse Amplitude Modulation (PAM)**: Variable pulse amplitude

#### **By Reference Signal:**
- **Sinusoidal PWM**: Sinusoidal reference
- **Space Vector PWM**: Vector-based approach  
- **Random PWM**: Stochastic switching patterns

#### **By Switching Frequency:**
- **Fixed Frequency**: Constant switching frequency
- **Variable Frequency**: Adaptive switching frequency
- **Hysteresis Control**: Band-limited switching

---

## 2. Fundamental PWM Concepts

### 2.1 Basic PWM Principle

PWM generates a train of pulses with varying width to control the average value of the output. The basic principle involves comparing a reference signal with a carrier signal.

#### **Key Parameters:**
- **Modulation Index (ma)**: Ratio of reference to carrier amplitude
- **Frequency Modulation Ratio (mf)**: Ratio of carrier to reference frequency
- **Duty Cycle (D)**: Ratio of ON time to total period

#### **Mathematical Relationship:**
```
ma = Vref/Vcarrier
mf = fcarrier/fref
D = ton/T
```

### 2.2 Carrier-Based PWM

#### **Triangular Carrier:**
- Most common carrier waveform
- Provides symmetric switching
- Linear modulation characteristics

#### **Sawtooth Carrier:**
- Asymmetric switching
- Single-edge modulation
- Simpler implementation

#### **Carrier Frequency Selection:**
Trade-offs in carrier frequency:
- **High frequency**: Lower harmonics, higher switching losses
- **Low frequency**: Higher harmonics, lower switching losses
- **Typical range**: 1-20 kHz for power applications

---

## 3. Sinusoidal Pulse Width Modulation (SPWM)

### 3.1 SPWM Principle

SPWM compares a sinusoidal reference signal with a triangular carrier wave to generate switching signals.

#### **Generation Process:**
1. **Reference Signal**: vref(t) = Vref sin(ωt)
2. **Carrier Signal**: Triangular wave at frequency fc
3. **Comparison**: Switch ON when vref > vcarrier
4. **Output**: Pulse train with varying width

### 3.2 Single-Phase SPWM

#### **Output Voltage Analysis:**

**For Linear Range (ma ≤ 1):**
```
Fundamental component: V1 = ma × Vdc/2
Harmonic content: Centered around mf and its multiples
```

**Fourier Analysis:**
```
vo(t) = (ma×Vdc/2)sin(ωt) + Σ[harmonics around mf]
```

#### **Modulation Index Effects:**
- **ma < 1**: Linear modulation, low distortion
- **ma = 1**: Maximum linear output, V1 = Vdc/2
- **ma > 1**: Overmodulation, increased harmonics

### 3.3 Three-Phase SPWM

#### **Reference Signals:**
```
vref_a(t) = Vref sin(ωt)
vref_b(t) = Vref sin(ωt - 2π/3)
vref_c(t) = Vref sin(ωt - 4π/3)
```

#### **Carrier Signal:**
Single triangular carrier shared by all three phases.

#### **Output Characteristics:**
**Phase Voltage (RMS):**
```
V1_phase = ma × Vdc/(2√2)
```

**Line-to-Line Voltage (RMS):**
```
V1_line = ma × √3 × Vdc/(2√2)
```

### 3.4 Harmonic Analysis of SPWM

#### **Harmonic Distribution:**
- **Fundamental**: At reference frequency
- **Carrier harmonics**: At mf ± 1, mf ± 2, etc.
- **Sideband harmonics**: Around multiples of mf

#### **THD Calculation:**
```
THD = √(V2² + V3² + V4² + ...)/V1
```

For well-designed SPWM with mf >> 1:
```
THD ≈ 0.31/√mf (for ma = 1)
```

#### **Design Guidelines:**
- **mf should be odd**: Eliminates even harmonics
- **mf >> 1**: Pushes harmonics to high frequency
- **Typical mf values**: 15-21 for good harmonic performance

---

## 4. Space Vector Modulation (SVM)

### 4.1 Space Vector Concept

Space Vector Modulation treats the three-phase system as a single rotating vector in a two-dimensional space.

#### **Space Vector Transformation:**
```
V⃗s = (2/3)[va + vb·e^(j2π/3) + vc·e^(j4π/3)]
```

#### **Vector Representation:**
In terms of α-β coordinates:
```
vα = va
vβ = (1/√3)(va + 2vb)
```

### 4.2 Basic Space Vectors

For a three-phase two-level inverter, there are 8 possible switching states:

#### **Active Vectors (V1-V6):**
- **V1 (100)**: |V| = 2Vdc/3, ∠0°
- **V2 (110)**: |V| = 2Vdc/3, ∠60°
- **V3 (010)**: |V| = 2Vdc/3, ∠120°
- **V4 (011)**: |V| = 2Vdc/3, ∠180°
- **V5 (001)**: |V| = 2Vdc/3, ∠240°
- **V6 (101)**: |V| = 2Vdc/3, ∠300°

#### **Zero Vectors:**
- **V0 (000)**: All lower switches ON
- **V7 (111)**: All upper switches ON

### 4.3 SVM Algorithm

#### **Reference Vector Synthesis:**
Any reference vector V⃗ref can be synthesized using two adjacent active vectors and zero vectors.

For reference vector in Sector 1:
```
V⃗ref × Ts = V⃗1 × T1 + V⃗2 × T2 + V⃗0 × T0
```

#### **Time Calculations:**
```
T1 = (√3 × Ts × |Vref|/Vdc) × sin(π/3 - θ)
T2 = (√3 × Ts × |Vref|/Vdc) × sin(θ)
T0 = Ts - T1 - T2
```

Where:
- Ts = switching period
- θ = angle of reference vector within sector
- |Vref| = magnitude of reference vector

### 4.4 Advantages of SVM

#### **Compared to SPWM:**
1. **15% higher output voltage**: Better DC bus utilization
2. **Lower harmonic distortion**: Optimized switching pattern
3. **Lower switching losses**: Reduced number of switchings
4. **Better control**: Direct control of voltage vector

#### **Mathematical Advantage:**
Maximum linear modulation with SVM:
```
VL,max = Vdc/√3 ≈ 0.577 Vdc
```

Compared to SPWM:
```
VL,max = Vdc/2 = 0.5 Vdc
```

Improvement: 15.47%

### 4.5 SVM Implementation

#### **Sector Identification:**
Based on the reference vector angle:
- **Sector 1**: 0° ≤ θ < 60°
- **Sector 2**: 60° ≤ θ < 120°
- **Sector 3**: 120° ≤ θ < 180°
- And so on...

#### **Switching Sequence:**
Common sequences for Sector 1:
- **Sequence 1**: V0-V1-V2-V7-V2-V1-V0
- **Sequence 2**: V0-V1-V2-V7-V7-V2-V1-V0

#### **Digital Implementation Steps:**
1. **Transform** three-phase references to α-β
2. **Calculate** sector and reference vector magnitude
3. **Compute** switching times T1, T2, T0
4. **Generate** switching pattern
5. **Update** PWM registers

---

## 5. Advanced PWM Techniques

### 5.1 Third Harmonic Injection PWM

#### **Principle:**
Add third harmonic component to sinusoidal references:
```
vref_modified = Vref sin(ωt) + k × Vref sin(3ωt)
```

Optimal injection: k = 1/6

#### **Advantages:**
- **Increased fundamental output**: Up to 15% improvement
- **Maintained linearity**: Linear modulation preserved
- **Zero effect on line voltages**: Third harmonic cancels in line-to-line voltages

#### **Mathematical Analysis:**
Maximum phase voltage with injection:
```
Vphase,max = (2/√3) × (Vdc/2) ≈ 0.577 Vdc
```

Without injection:
```
Vphase,max = Vdc/2 = 0.5 Vdc
```

### 5.2 Discontinuous PWM (DPWM)

#### **Principle:**
One phase remains unclamped (not switched) during each 60° interval.

#### **Types:**
- **DPWM1**: Clamps maximum phase
- **DPWM2**: Clamps minimum phase  
- **DPWM3**: Clamps middle phase

#### **Advantages:**
- **Reduced switching losses**: 33% reduction in switching frequency
- **Lower EMI**: Reduced high-frequency content
- **Improved efficiency**: Especially at high modulation indices

#### **Disadvantages:**
- **Higher low-order harmonics**: Compared to continuous PWM
- **Complex control**: Sector-dependent clamping

### 5.3 Random PWM

#### **Principle:**
Introduces controlled randomness in switching pattern to spread harmonic spectrum.

#### **Methods:**
- **Random carrier frequency**: Varies switching frequency
- **Random pulse position**: Shifts pulse timing
- **Random switching sequence**: Varies vector sequence

#### **Benefits:**
- **Reduced acoustic noise**: Spreads discrete harmonics
- **Lower EMI**: Continuous spectrum vs. discrete lines
- **Improved electromagnetic compatibility**

#### **Challenges:**
- **Increased control complexity**
- **Potential for increased total harmonic energy**
- **Digital implementation requirements**

---

## 6. Multilevel Modulation Techniques

### 6.1 Carrier-Based PWM for Multilevel Inverters

#### **Level-Shifted PWM:**
Multiple triangular carriers with different DC offsets:
- **Phase Disposition (PD)**: All carriers in phase
- **Phase Opposition Disposition (POD)**: Alternating phase
- **Alternative Phase Opposition Disposition (APOD)**: Modified alternating

#### **For n-level inverter:**
- **Number of carriers**: n-1
- **Carrier amplitude**: Vdc/(n-1)
- **Reference comparison**: With all carriers simultaneously

### 6.2 Space Vector PWM for Multilevel

#### **3-Level Space Vector:**
- **19 space vectors**: 12 medium, 6 large, 1 zero
- **24 sectors**: More complex than 2-level
- **Vector selection**: Based on reference location

#### **Algorithm Complexity:**
- **Sector identification**: More complex logic
- **Time calculations**: Multiple vector combinations
- **Neutral point balancing**: Additional constraint

### 6.3 Selective Harmonic Elimination (SHE)

#### **Principle:**
Pre-calculate switching angles to eliminate specific harmonics while controlling the fundamental.

#### **For quarter-wave symmetry:**
```
V1 = (4Vdc/π) Σ cos(αi)
V5 = (4Vdc/5π) Σ cos(5αi) = 0
V7 = (4Vdc/7π) Σ cos(7αi) = 0
...
```

#### **Solution Method:**
- **Transcendental equations**: Non-linear system
- **Numerical methods**: Newton-Raphson iteration
- **Lookup tables**: Pre-computed solutions

#### **Advantages:**
- **Eliminates specific harmonics**: Low-order harmonics
- **Optimal switching pattern**: Minimum switching frequency
- **High power applications**: Suitable for high-power converters

#### **Disadvantages:**
- **Complex computation**: Real-time calculation difficult
- **Limited control range**: Discrete solutions only
- **No closed-loop capability**: Open-loop control

---

## 7. Modulation for Specific Applications

### 7.1 Motor Drive Applications

#### **V/f Control:**
Maintains constant volts-per-hertz ratio:
```
V/f = constant
ma = (fref/frated) × (Vrated/Vdc)
```

#### **Field-Oriented Control (FOC):**
- **d-q transformation**: Rotating reference frame
- **Decoupled control**: Independent torque and flux control
- **Space vector modulation**: Optimal voltage utilization

#### **Direct Torque Control (DTC):**
- **Hysteresis control**: Torque and flux bands
- **Vector table**: Pre-defined switching vectors
- **Fast response**: Minimal delay control

### 7.2 Grid-Tied Applications

#### **Current Control:**
- **Current reference**: Based on power command
- **Grid synchronization**: Phase-locked loop (PLL)
- **Power factor control**: Leading/lagging capability

#### **Grid Support Functions:**
- **Voltage support**: Reactive power injection
- **Frequency support**: Active power modulation
- **Fault ride-through**: Continuous operation during faults

### 7.3 Active Filter Applications

#### **Harmonic Compensation:**
- **Reference generation**: From load current analysis
- **Selective compensation**: Specific harmonic orders
- **Adaptive control**: Varying load conditions

#### **Power Factor Correction:**
- **Unity power factor**: Sinusoidal current in phase with voltage
- **Reactive power compensation**: Leading/lagging correction
- **Dynamic response**: Fast load change response

---

## 8. Comparison of Modulation Techniques

### 8.1 Performance Comparison

| Technique | THD | Switching Losses | Control Complexity | DC Bus Utilization |
|-----------|-----|------------------|-------------------|-------------------|
| Square Wave | 48.3% | Low | Very Simple | 78.5% |
| SPWM | 5-15% | Medium | Simple | 78.5% |
| SVPWM | 3-12% | Medium-Low | Medium | 90.7% |
| DPWM | 8-20% | Low | Medium-High | 90.7% |
| SHE | Very Low | Very Low | High | Variable |

### 8.2 Application Suitability

#### **Low-Cost Applications:**
- **Square wave**: Simple control, acceptable quality
- **Basic SPWM**: Good compromise

#### **High-Performance Applications:**
- **SVPWM**: Motor drives, grid inverters
- **Advanced PWM**: Premium applications

#### **High-Power Applications:**
- **SHE**: Minimal switching, custom harmonics
- **Multilevel PWM**: High voltage capability

---

## 9. Digital Implementation

### 9.1 Microcontroller Implementation

#### **Hardware Requirements:**
- **High-resolution timers**: PWM generation
- **Fast ADC**: Feedback sampling
- **Sufficient memory**: Lookup tables and algorithms
- **Real-time OS**: Deterministic execution

#### **Software Structure:**
```
Main Loop:
1. Read feedback signals
2. Calculate reference values
3. Execute modulation algorithm
4. Update PWM registers
5. Handle protection functions
```

### 9.2 FPGA Implementation

#### **Advantages:**
- **Parallel processing**: Simultaneous calculations
- **High resolution**: Nanosecond precision
- **Deterministic timing**: No jitter
- **Custom hardware**: Optimized for specific algorithms

#### **Implementation Considerations:**
- **Resource utilization**: Logic elements and memory
- **Clock management**: Multiple clock domains
- **Interface design**: Communication with external systems

### 9.3 DSP Implementation

#### **Specialized Features:**
- **Fixed-point arithmetic**: Efficient calculations
- **Parallel MAC units**: Fast vector operations
- **Integrated peripherals**: PWM, ADC, communication
- **Development tools**: Optimized compilers and debuggers

---

## 10. Design Example: SPWM System

### 10.1 Specifications

**Design SPWM controller for:**
- Three-phase inverter
- Output: 400V line-to-line, 50Hz
- DC input: 600V
- Switching frequency: 5kHz
- THD requirement: <5%

### 10.2 Design Process

#### **Step 1: Calculate Modulation Parameters**
```
Required line voltage (RMS): VLL = 400V
Required phase voltage (RMS): Vph = 400/√3 = 231V
Peak phase voltage required: Vph,peak = 231 × √2 = 327V

For SPWM: Vph,peak = ma × Vdc/2
ma = (327 × 2)/600 = 1.09
```

Since ma > 1, we're in overmodulation region.

#### **Step 2: Adjust for Linear Operation**
```
For linear operation (ma = 0.95):
Vph,peak = 0.95 × 600/2 = 285V
Vph,RMS = 285/√2 = 201V
VLL,RMS = 201 × √3 = 349V
```

This gives 349V instead of 400V required.

#### **Step 3: Consider Third Harmonic Injection**
```
With optimal injection (k = 1/6):
Maximum ma = 2/√3 ≈ 1.155

Available phase voltage: Vph = 1.155 × 600/(2√2) = 245V
Available line voltage: VLL = 245 × √3 = 425V ✓
```

This meets the requirement.

#### **Step 4: Frequency Ratio Selection**
```
mf = fsw/f0 = 5000/50 = 100
```

This is even, so adjust to mf = 99 (odd number) for better harmonic performance.
```
Actual switching frequency: fsw = 99 × 50 = 4.95kHz
```

#### **Step 5: THD Estimation**
```
For SPWM with mf = 99:
THD ≈ 0.31/√99 ≈ 3.1% ✓
```

This meets the <5% requirement.

### 10.3 Implementation Parameters

#### **Final Design Parameters:**
- **Modulation technique**: SPWM with third harmonic injection
- **Modulation index**: ma = 1.155
- **Switching frequency**: 4.95kHz
- **Carrier frequency ratio**: mf = 99
- **Expected THD**: ~3.1%
- **Expected efficiency**: >95%

---

## 11. Measurement and Testing

### 11.1 Harmonic Analysis

#### **Measurement Equipment:**
- **Power quality analyzer**: THD measurement
- **Oscilloscope with FFT**: Harmonic spectrum
- **Spectrum analyzer**: Frequency domain analysis

#### **Key Measurements:**
- **THD**: Total harmonic distortion
- **Individual harmonics**: Up to 50th harmonic
- **Interharmonics**: Between integer harmonics
- **Modulation depth**: Effective modulation index

### 11.2 Switching Loss Analysis

#### **Measurement Methods:**
- **Power analyzer**: Total input/output power
- **Thermal imaging**: Device temperature
- **Current probes**: Switching current waveforms

#### **Calculation Methods:**
```
Switching losses: Psw = (Eon + Eoff) × fsw
Conduction losses: Pcond = Irms² × Ron
Total losses: Ptotal = Psw + Pcond
Efficiency: η = Pout/(Pout + Ptotal)
```

---

## 12. Future Trends in Modulation

### 12.1 Model Predictive Control (MPC)

#### **Principle:**
Uses system model to predict future behavior and optimize control action.

#### **Advantages:**
- **Fast dynamic response**: Single sampling period delay
- **Constraint handling**: Naturally includes limitations
- **Multi-objective optimization**: Balances multiple criteria

#### **Challenges:**
- **Model dependency**: Requires accurate system model
- **Computational complexity**: High processing requirements
- **Parameter sensitivity**: Performance depends on model accuracy

### 12.2 Artificial Intelligence in Modulation

#### **Machine Learning Applications:**
- **Optimal switching patterns**: Learning from data
- **Adaptive modulation**: Self-tuning parameters
- **Predictive maintenance**: Fault detection through patterns

#### **Neural Network Controllers:**
- **Pattern recognition**: Complex modulation strategies
- **Real-time optimization**: Adaptive to operating conditions
- **Fault tolerance**: Robust operation under component failures

---

## Summary

Modulation techniques are fundamental to achieving high-performance power electronic systems. The choice of modulation strategy significantly impacts harmonic content, switching losses, control complexity, and overall system performance.

**Key Takeaways:**
1. **SPWM**: Simple implementation, good harmonic performance
2. **SVPWM**: Superior DC bus utilization, lower harmonics
3. **Advanced techniques**: Trade-offs between performance and complexity
4. **Application-specific**: Selection based on requirements
5. **Digital implementation**: Enables complex algorithms and adaptive control

**Selection Guidelines:**

| Priority | Recommended Technique | Applications |
|----------|----------------------|--------------|
| Simplicity | SPWM | Low-cost drives, UPS |
| Performance | SVPWM | High-performance drives |
| Efficiency | DPWM, SHE | High-power converters |
| Low harmonics | SHE, Advanced PWM | Grid applications |
| Flexibility | Model Predictive | Research, premium systems |

---

## Next Lecture
**Topic**: Control Systems for Power Electronics
**Reading Assignment**: Chapter 7, Sections 7.1-7.3
**Problem Set**: Modulation analysis and design problems

---

## Practice Problems

**Problem 1**: Design an SPWM system for a single-phase inverter with:
- DC input: 200V
- Required output: 120V RMS, 60Hz
- Switching frequency: 3.6kHz
Calculate: modulation index, frequency ratio, expected THD

**Problem 2**: Compare SPWM and SVPWM for a three-phase system:
- DC bus: 400V
- Required line voltage: 240V RMS
- Calculate maximum achievable output for both methods
- Determine the advantage of SVPWM

**Problem 3**: For a 5-level cascaded H-bridge inverter using SHE:
- Calculate switching angles to eliminate 5th and 7th harmonics
- Fundamental output should be 80% of maximum possible
- Verify the solution eliminates the specified harmonics

**Problem 4**: Design third harmonic injection PWM:
- Three-phase system with 600V DC bus
- Required output: 400V line-to-line RMS
- Calculate injection ratio and resulting modulation index
- Compare with standard SPWM performance

**Problem 5**: Implement space vector modulation algorithm:
- Reference vector: magnitude 0.8 pu, angle 45°
- Calculate sector, adjacent vectors, and switching times
- Determine the switching sequence for one carrier period
